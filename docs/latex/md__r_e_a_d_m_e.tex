Generalized dual dynamic programming (G\+D\+DP) tool written in Python. This tool creates an approximate lower bounds on a given control problem\textquotesingle{}s optimal value function using the Benders decomposition approach developed in \mbox{[}1\mbox{]}.

\subsection*{Getting Started}

Make a system, either by specifying a system\textquotesingle{}s dynamics via a {\ttfamily model\+\_\+dict}, or by calling on one of the preset systems hard-\/coded in the definition of class {\ttfamily System}.


\begin{DoxyCode}{0}
\DoxyCodeLine{from gddp import System, VFApproximator}
\DoxyCodeLine{sys1 = System(name='Simple 1D system', model\_preset='1D')}
\end{DoxyCode}


The {\ttfamily System} object carried not only the dynamics and constraints of the system itself, but also the stage cost function and discount factor.

You can now pass this system to a {\ttfamily V\+F\+Approximator} object, and create an approximation of the problem\textquotesingle{}s value function\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{vfa = VFApproximator(system=sys1)}
\DoxyCodeLine{vfa.create\_vfa\_model()}
\DoxyCodeLine{vfa.approximate()}
\end{DoxyCode}


By default, this performs the Benders decomposition algorithm at 100 randomly-\/chosen points in the state space, normally distributed about the origin.

The routine creates a number of output files that contain information on the value function created.

\subsubsection*{Q functions}

Some functionality also exists for working with Q functions, which are defined on state-\/action space rather than the state alone. The syntax is the same\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{from gddp import QFApproximator}
\DoxyCodeLine{qfa = QFApproximator(system=sys1)}
\DoxyCodeLine{qfa.create\_qfa\_model()}
\DoxyCodeLine{qfa.approximate()}
\end{DoxyCode}


\subsection*{Output format}

The function {\ttfamily print\+\_\+function\+\_\+approximation()} prints, and optionally saves to a text file, an explicit representation in string form of the final value function.

The function {\ttfamily save\+\_\+function\+\_\+approximation()} creates a .mat file containing the constant, linear, and quadratic components of the lower-\/bounding functions that define the V-\/ or Q-\/function approximation.

Example usage\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{vfa.print\_function\_approximation(command\_line=True, save=False)}
\DoxyCodeLine{vfa.save\_function\_approximation()}
\end{DoxyCode}


The .mat file generated by the latter function contains the following entries, where {\itshape I} is the number of G\+D\+DP iterations that added a lower bounding function, {\itshape n} is the state dimension, and {\itshape m} is the input dimension\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Function saved  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Variable  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Dimension  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description   }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Function saved  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Variable  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Dimension  }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Description   }\\\cline{1-4}
\endhead
V  &g\+\_\+const  &( {\itshape I}+1, 1)  &Constant component of VF lower bounding function   \\\cline{1-4}
V  &g\+\_\+lin  &( {\itshape I}+1, {\itshape n})  &Linear component of VF lower bounding function   \\\cline{1-4}
V  &g\+\_\+quad  &( {\itshape I}+1, {\itshape n}, {\itshape n})  &Quadratic (Hessian) component of VF lower bounding function   \\\cline{1-4}
Q  &q\+\_\+const  &( {\itshape I}+1, 1)  &Constant component of VF lower bounding function   \\\cline{1-4}
Q  &q\+\_\+x\+\_\+lin  &( {\itshape I}+1, {\itshape n})  &Linear x component of VF lower bounding function   \\\cline{1-4}
Q  &q\+\_\+x\+\_\+quad  &( {\itshape I}+1, {\itshape n}, {\itshape n})  &Quadratic (Hessian) x component of VF lower bounding function   \\\cline{1-4}
Q  &q\+\_\+u\+\_\+lin  &( {\itshape I}+1, {\itshape m})  &Linear u component of VF lower bounding function   \\\cline{1-4}
Q  &q\+\_\+u\+\_\+quad  &( {\itshape I}+1, {\itshape m}, {\itshape m})  &Quadratic (Hessian) u component of VF lower bounding function   \\\cline{1-4}
\end{longtabu}


\subsection*{References}

\mbox{[}1\mbox{]} J. Warrington, P. Beuchat, J. Lygeros, \char`\"{}\+Generalized Dual Dynamic Programming for Infinite Horizon Problems in Continuous State and Action Spaces\char`\"{}, {\itshape I\+E\+EE Transactions on Automatic Control, to appear December 2019.}

\mbox{[}2\mbox{]} J. Warrington, \char`\"{}\+Learning Continuous Q-\/\+Functions via generalized Benders cuts\char`\"{}, {\itshape European Control Conference 2019, Naples, Italy, June 2019.} 